diff -u a/node.def b/node.def
--- a/node.def	2018-09-21 23:26:41.979116500 +0800
+++ b/node.def	2018-09-21 23:20:55.951525100 +0800
@@ -1,6 +1,7 @@
 multi:
-type: ipv4net
+type: txt
 val_help: ipv4net; IPv4 address and prefix length
+val_help: ipv6net; IPv6 address and prefix length
 help: IP address
 
 syntax:expression: exec "/opt/vyatta/sbin/valid_address $VAR(@)"
diff -u a/vpn-config.pl b/vpn-config.pl
--- a/vpn-config.pl	2018-09-21 21:07:34.824295100 +0800
+++ b/vpn-config.pl	2018-09-22 00:44:04.353028300 +0800
@@ -473,12 +473,6 @@
             #
             if (defined($lip)) {
                 if ($lip eq 'any' || $lip eq 'default') {
-                    if ($isVti) {
-                        vpn_die(
-                            ["vpn", "ipsec", "site-to-site", "peer", $peer, $tunKeyword, "local-address"],
-                            "$vpn_cfg_err The local interface must be specified " . "for peer \"$peer\" $tunKeyword.\n"
-                        );
-                    }
                     if ($lip eq 'default') {
                         $genout .= "\tleft=%defaultroute\n";
                     } else {
@@ -541,7 +535,7 @@
             #
             my $leftsubnet = $vcVPN->returnValue("ipsec site-to-site peer $peer $tunKeyword local prefix");
             if ((defined($leftsubnet) && $leftsubnet eq 'any') || $isVti == 1) {
-                $leftsubnet = '0.0.0.0/0';
+                $leftsubnet = $isVti == 1 ? '0.0.0.0/0,::/0' : '0.0.0.0/0';
             }
 
             if (defined($leftsubnet)) {
@@ -629,7 +623,7 @@
             } else {
                 $rightsubnet = $remotesubnet;
                 if (defined($rightsubnet) && $rightsubnet eq 'any') {
-                    $rightsubnet = '0.0.0.0/0';
+                    $rightsubnet = $isVti == 1 ? '0.0.0.0/0,::/0' : '0.0.0.0/0';
                 }
             }
             if (defined($rightsubnet)) {
@@ -996,7 +990,7 @@
                 my $index2 = (defined($authremoteid)) ? "$authremoteid" : $right;
                 if (  ($lip eq 'any' || $lip eq 'default' ||
                           ($key_exchange eq 'ikev1' and $index2 eq '%any')
-                      ) && !defined($dhcp_iface)) {
+                      ) && !defined($authid) && !defined($dhcp_iface)) {
                     if ($index1 =~ m/^@/) {
                         # In main mode PSK, the responder needs to look up the secret
                         # before the Peer's ID payload has been decoded, so the ID used
@@ -1113,7 +1107,11 @@
             # and up/down script hook.
             #
             if ($isVti) {
-                my $mark = vtiIntf::isVtimarkpresent($peer, $lip);
+                my $marklip = $lip;
+                if (defined($dhcp_iface) || $lip eq 'any' || $lip eq 'default') {
+                    $marklip = '0.0.0.0';
+                }
+                my $mark = vtiIntf::isVtimarkpresent($peer, $marklip);
                 if (!defined($mark) || $mark eq '') {
                     vpn_die(["vpn", "ipsec", "site-to-site", "peer", $peer, "vti"], "$vpn_cfg_err No mark specified for peer \"$peer\" vti\n");
                 } else {
diff -u a/vtiIntf.pm b/vtiIntf.pm
--- a/vtiIntf.pm	2018-09-21 21:56:59.785500000 +0800
+++ b/vtiIntf.pm	2018-09-21 22:05:14.083014800 +0800
@@ -70,6 +70,9 @@
     if ($tunop =~ m/local ([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+)/) {
         $local = $1;
     }
+    if ($tunop =~ m/local any/) {
+        $local = '0.0.0.0';
+    }
     if ($tunop =~ m/okey ([0-9\.]+)/) {
         $mark = $1;
     }
@@ -85,6 +88,9 @@
     if ($key =~ m/local ([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+)/) {
         $local = $1;
     }
+    if ($key =~ m/local any/) {
+        $local = '0.0.0.0';
+    }
     return($remote, $local);
 }
 
diff -u a/vyatta-vti-config.pl b/vyatta-vti-config.pl
--- a/vyatta-vti-config.pl	2018-09-21 21:08:31.476826000 +0800
+++ b/vyatta-vti-config.pl	2018-09-22 00:40:37.280252500 +0800
@@ -115,6 +115,9 @@
     my @peers = $vcVPN->listNodes('ipsec site-to-site peer');
     foreach my $peer (@peers) {
         my $lip = $vcVPN->returnValue("ipsec site-to-site peer $peer local-address");
+        if (!defined($lip) || $lip eq 'default' || $lip eq 'any') {
+            $lip = '0.0.0.0';
+        }
         my $tunName = $vcVPN->returnValue("ipsec site-to-site peer $peer vti bind");
 
         # Do not delete old VTI tunnels if we are not going to create new one
@@ -153,6 +156,9 @@
         #
         my $mark;
         my $lip = $vcVPN->returnValue("ipsec site-to-site peer $peer local-address");
+        if (!defined($lip) || $lip eq 'any' || $lip eq 'default') {
+            $lip = '0.0.0.0';
+        }
         my $tunName = $vcVPN->returnValue("ipsec site-to-site peer $peer vti bind");
         my $change = 0;
 
@@ -162,7 +168,7 @@
             exit -1;
         }
         if (!(validateType('ipv4', $lip, 'quiet') || 
-              validateType('ipv6', $lip, 'quiet')) || ($lip eq '0.0.0.0')) {
+              validateType('ipv6', $lip, 'quiet'))) {
             print STDERR "$vti_cfg_err Invalid local-address \"$lip\", an ip address must be specified for VTIs.\n";
             exit -1;
         }
